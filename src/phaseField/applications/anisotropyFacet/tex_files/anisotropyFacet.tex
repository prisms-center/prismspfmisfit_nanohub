\documentclass[10pt]{article}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{bbm}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{epsfig}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage{psfrag}
\newcommand{\sun}{\ensuremath{\odot}} % sun symbol is \sun
\let\vaccent=\v % rename builtin command \v{} to \vaccent{}
\renewcommand{\v}[1]{\ensuremath{\mathbf{#1}}} % for vectors
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}} 
\newcommand{\grad}[1]{\gv{\nabla} #1}
\renewcommand{\baselinestretch}{1.2}
\jot 5mm
\graphicspath{{./figures/}}
%text dimensions
\textwidth 6.5 in
\oddsidemargin .2 in
\topmargin -0.2 in
\textheight 8.5 in
\headheight 0.2in
\overfullrule = 0pt
\pagestyle{plain}
\def\newpar{\par\vskip 0.5cm}
\begin{document}
%
%----------------------------------------------------------------------
%        Define symbols
%----------------------------------------------------------------------
%
\def\iso{\mathbbm{1}}
\def\half{{\textstyle{1 \over 2}}}
\def\third{{\textstyle{1 \over 3}}}
\def\fourth{{\textstyle{{1 \over 4}}}}
\def\twothird{{\textstyle {{2 \over 3}}}}
\def\ndim{{n_{\rm dim}}}
\def\nint{n_{\rm int}}
\def\lint{l_{\rm int}}
\def\nel{n_{\rm el}}
\def\nf{n_{\rm f}}
\def\DIV {\hbox{\af div}}
\def\GRAD{\hbox{\af Grad}}
\def\sym{\mathop{\rm sym}\nolimits}
\def\tr{\mathop{\rm tr}\nolimits}
\def\dev{\mathop{\rm dev}\nolimits}
\def\Dev{\mathop{\rm Dev}\nolimits}
\def\DEV{\mathop {\rm DEV}\nolimits}
\def\bfb {{\bi b}}
\def\Bnabla{\nabla}
\def\bG{{\bi G}}
\def\jmpdelu{{\lbrack\!\lbrack \Delta u\rbrack\!\rbrack}}
\def\jmpudot{{\lbrack\!\lbrack\dot u\rbrack\!\rbrack}}
\def\jmpu{{\lbrack\!\lbrack u\rbrack\!\rbrack}}
\def\jmphi{{\lbrack\!\lbrack\varphi\rbrack\!\rbrack}}
\def\ljmp{{\lbrack\!\lbrack}}
\def\rjmp{{\rbrack\!\rbrack}}
\def\sign{{\rm sign}}
\def\nn{{n+1}}
\def\na{{n+\vartheta}}
\def\nna{{n+(1-\vartheta)}}
\def\nt{{n+{1\over 2}}}
\def\nb{{n+\beta}}
\def\nbb{{n+(1-\beta)}}
%---------------------------------------------------------
%               Bold Face Math Characters:
%               All In Format: \B***** .
%---------------------------------------------------------
\def\bOne{\mbox{\boldmath$1$}}
\def\BGamma{\mbox{\boldmath$\Gamma$}}
\def\BDelta{\mbox{\boldmath$\Delta$}}
\def\BTheta{\mbox{\boldmath$\Theta$}}
\def\BLambda{\mbox{\boldmath$\Lambda$}}
\def\BXi{\mbox{\boldmath$\Xi$}}
\def\BPi{\mbox{\boldmath$\Pi$}}
\def\BSigma{\mbox{\boldmath$\Sigma$}}
\def\BUpsilon{\mbox{\boldmath$\Upsilon$}}
\def\BPhi{\mbox{\boldmath$\Phi$}}
\def\BPsi{\mbox{\boldmath$\Psi$}}
\def\BOmega{\mbox{\boldmath$\Omega$}}
\def\Balpha{\mbox{\boldmath$\alpha$}}
\def\Bbeta{\mbox{\boldmath$\beta$}}
\def\Bgamma{\mbox{\boldmath$\gamma$}}
\def\Bdelta{\mbox{\boldmath$\delta$}}
\def\Bepsilon{\mbox{\boldmath$\epsilon$}}
\def\Bzeta{\mbox{\boldmath$\zeta$}}
\def\Beta{\mbox{\boldmath$\eta$}}
\def\Btheta{\mbox{\boldmath$\theta$}}
\def\Biota{\mbox{\boldmath$\iota$}}
\def\Bkappa{\mbox{\boldmath$\kappa$}}
\def\Blambda{\mbox{\boldmath$\lambda$}}
\def\Bmu{\mbox{\boldmath$\mu$}}
\def\Bnu{\mbox{\boldmath$\nu$}}
\def\Bxi{\mbox{\boldmath$\xi$}}
\def\Bpi{\mbox{\boldmath$\pi$}}
\def\Brho{\mbox{\boldmath$\rho$}}
\def\Bsigma{\mbox{\boldmath$\sigma$}}
\def\Btau{\mbox{\boldmath$\tau$}}
\def\Bupsilon{\mbox{\boldmath$\upsilon$}}
\def\Bphi{\mbox{\boldmath$\phi$}}
\def\Bchi{\mbox{\boldmath$\chi$}}
\def\Bpsi{\mbox{\boldmath$\psi$}}
\def\Bomega{\mbox{\boldmath$\omega$}}
\def\Bvarepsilon{\mbox{\boldmath$\varepsilon$}}
\def\Bvartheta{\mbox{\boldmath$\vartheta$}}
\def\Bvarpi{\mbox{\boldmath$\varpi$}}
\def\Bvarrho{\mbox{\boldmath$\varrho$}}
\def\Bvarsigma{\mbox{\boldmath$\varsigma$}}
\def\Bvarphi{\mbox{\boldmath$\varphi$}}
\def\bone{\mathbf{1}}
\def\bzero{\mathbf{0}}
%---------------------------------------------------------
%               Bold Face Math Italic:
%               All In Format: \b* .
%---------------------------------------------------------
\def\bA{\mbox{\boldmath$ A$}}
\def\bB{\mbox{\boldmath$ B$}}
\def\bC{\mbox{\boldmath$ C$}}
\def\bD{\mbox{\boldmath$ D$}}
\def\bE{\mbox{\boldmath$ E$}}
\def\bF{\mbox{\boldmath$ F$}}
\def\bG{\mbox{\boldmath$ G$}}
\def\bH{\mbox{\boldmath$ H$}}
\def\bI{\mbox{\boldmath$ I$}}
\def\bJ{\mbox{\boldmath$ J$}}
\def\bK{\mbox{\boldmath$ K$}}
\def\bL{\mbox{\boldmath$ L$}}
\def\bM{\mbox{\boldmath$ M$}}
\def\bN{\mbox{\boldmath$ N$}}
\def\bO{\mbox{\boldmath$ O$}}
\def\bP{\mbox{\boldmath$ P$}}
\def\bQ{\mbox{\boldmath$ Q$}}
\def\bR{\mbox{\boldmath$ R$}}
\def\bS{\mbox{\boldmath$ S$}}
\def\bT{\mbox{\boldmath$ T$}}
\def\bU{\mbox{\boldmath$ U$}}
\def\bV{\mbox{\boldmath$ V$}}
\def\bW{\mbox{\boldmath$ W$}}
\def\bX{\mbox{\boldmath$ X$}}
\def\bY{\mbox{\boldmath$ Y$}}
\def\bZ{\mbox{\boldmath$ Z$}}
\def\ba{\mbox{\boldmath$ a$}}
\def\bb{\mbox{\boldmath$ b$}}
\def\bc{\mbox{\boldmath$ c$}}
\def\bd{\mbox{\boldmath$ d$}}
\def\be{\mbox{\boldmath$ e$}}
\def\bff{\mbox{\boldmath$ f$}}
\def\bg{\mbox{\boldmath$ g$}}
\def\bh{\mbox{\boldmath$ h$}}
\def\bi{\mbox{\boldmath$ i$}}
\def\bj{\mbox{\boldmath$ j$}}
\def\bk{\mbox{\boldmath$ k$}}
\def\bl{\mbox{\boldmath$ l$}}
\def\bm{\mbox{\boldmath$ m$}}
\def\bn{\mbox{\boldmath$ n$}}
\def\bo{\mbox{\boldmath$ o$}}
\def\bp{\mbox{\boldmath$ p$}}
\def\bq{\mbox{\boldmath$ q$}}
\def\br{\mbox{\boldmath$ r$}}
\def\bs{\mbox{\boldmath$ s$}}
\def\bt{\mbox{\boldmath$ t$}}
\def\bu{\mbox{\boldmath$ u$}}
\def\bv{\mbox{\boldmath$ v$}}
\def\bw{\mbox{\boldmath$ w$}}
\def\bx{\mbox{\boldmath$ x$}}
\def\by{\mbox{\boldmath$ y$}}
\def\bz{\mbox{\boldmath$ z$}}
%*********************************
%Start main paper
%*********************************
\centerline{\Large{\bf PRISMS PhaseField}}
\smallskip
\centerline{\Large{\bf Faceted Anisotropy (with Coupled CH-AC Dynamics)}}
\bigskip

This application is essentially a specialization of the CHAC\_anisotropyRegarized application with a particular choice of interfacial energy anisotropy $\gamma(\mathbf{n})$.  In this document, we repeat the formulation for that model for completeness and then describe the anisotropy used in this application.  Consider a free energy expression of the form:
\begin{equation}
  \Pi(c, \eta, \grad  \eta) = \int_{\Omega}    \left( f_{\alpha}(1-H) + f_{\beta}H \right)  + \frac{1}{2} | \gamma( \mathbf{n} ) \grad  \eta |^2  + \frac{\delta^2}{2} (\Delta \eta)^2 ~dV 
\end{equation}
where $f_{\alpha}$ and $f_{\beta}$ are the free energy densities corresponding to $\alpha$ and $\beta$ phases, respectively, and are functions of composition $c$. $H$ is a function of the structural order parameter $\eta$.  $\delta$ is a scalar regularization parameter.  The interface normal vector $\mathbf{n}$ is given by 
\begin{equation}
\mathbf{n} = \frac{\grad \eta}{|\grad \eta|}
\end{equation}
for $\grad \eta \ne \mathbf{0}$, and $\mathbf{n} = \mathbf{0}$ when $\grad \eta = \mathbf{0}$.

\section{Variational treatment}
Following standard variational arguments (see Cahn-Hilliard formulation), we obtain the chemical potentials:
\begin{align}
  \mu_{c}  &= (f_{\alpha,c}(1-H)+f_{\beta,c}H)  \\
  \mu_{\eta}  &= (f_{\beta,c}-f_{\alpha,c})H_{,\eta} - \grad \cdot \mathbf{m} + \delta^2 \Delta(\Delta \eta)
\end{align}
The components of the anisotropic gradient $\mathbf{m}$ are given by
\begin{equation}
m_i = \gamma(\mathbf{n}) \left( \grad \eta + |\grad \eta| (\delta_{ij}-n_i n_j) \frac{\partial \gamma (\mathbf{n})}{n_j} \right),
\end{equation}
where $\delta_{ij}$ is the Kronecker delta.

\section{Kinetics}
Now the PDE for Cahn-Hilliard dynamics is given by:
\begin{align}
  \frac{\partial c}{\partial t} &= -~\grad \cdot (-M_c\grad \mu_c)\\
  &=M_c~\grad \cdot (\grad (f_{\alpha,c}(1-H)+f_{\beta,c}H)) 
  \end{align}
  and the PDE for Allen-Cahn dynamics is given by:
  \begin{align}
    \frac{\partial \eta}{\partial t} &= -M_\eta \mu_\eta \\
  &=-M_\eta ~ [(f_{\beta,c}-f_{\alpha,c})H_{,\eta} - \grad \cdot \mathbf{m} + \delta^2 \Delta(\Delta \eta)]
\end{align}
where $M_c$ and $M_\eta$ are the constant mobilities.  In order that the formulation only includes second order derivatives, an auxiliary field $\phi$ is introduced to break up the biharmonic term:
\begin{align}
\phi = \Delta \eta
\end{align}
and the PDE for Allen-Cahn dynamics becomes 
\begin{align}
    \frac{\partial \eta}{\partial t} =-M_\eta ~ ((f_{\beta,c}-f_{\alpha,c})H_{,\eta} - \grad \cdot \mathbf{m}) + \delta^2 \Delta \phi .
\end{align}

\section{Time discretization}
Considering forward Euler explicit time stepping, we have the time discretized kinetics equation:
\begin{align}
 \phi^{n+1} &= \Delta \eta^n \\
 \eta^{n+1} &= \eta^{n}  - \Delta t M_{\eta}~ ((f_{\beta,c}^n-f_{\alpha,c}^n)H_{,\eta}^n -  \grad \cdot \mathbf{m}^n + \delta^2 \Delta \phi^n) \\
c^{n+1} &= c^{n}  + \Delta t M_{\eta}~\grad \cdot (\grad (f_{\alpha,c}^n(1-H^{n})+f_{\beta,c}^n H^{n}))
\end{align}

\section{Weak formulation}
In the weak formulation, considering an arbitrary variation $w$, the above equations can be expressed as residual equations.
\begin{align}
  \int_{\Omega}   w  \phi^{n+1}  ~dV &=\int_{\Omega}  \grad w \cdot \underbrace{ \grad \eta^n }_{r_{\phi x}} ~dV 
\end{align}

\begin{align}
  \int_{\Omega}   w  \eta^{n+1}  ~dV &= \int_{\Omega}   w \eta^{n} -   w    \Delta t M_{\eta}~ ((f_{\beta,c}^n-f_{\alpha,c}^n)H_{,\eta}^n - \kappa \Delta \eta^n)  ~dV\\
  &=\int_{\Omega}  w  \left( \underbrace{\eta^{n} - \Delta t M_{\eta}~ ((f_{\beta,c}^n-f_{\alpha,c}^n)H_{,\eta}^n)}_{r_{\eta}} \right)+ \grad w \cdot \underbrace{(- \Delta t M_{\eta})  ( \mathbf{m}^n - \delta^2 \phi^n)}_{r_{\eta x}} ~dV 
\end{align}
and 
\begin{align}
  \int_{\Omega}   w  c^{n+1}  ~dV &= \int_{\Omega}   w c^{n} + w    \Delta t M_{c}~ \grad \cdot (\grad (f_{\alpha,c}^n(1-H^{n})+f_{\beta,c}^n H^{n}))  ~dV\\
    &= \int_{\Omega}   w \underbrace{c^{n}}_{r_c} +  \grad w   \underbrace{(-\Delta t M_{c})~ [~(f_{\alpha,cc}^n(1-H^{n})+f_{\beta,cc}^n H^{n}) \grad c + ~((f_{\beta,c}^n-f_{\alpha,c}^n)H^{n}_{,\eta} \grad \eta^n) ] }_{r_{cx}} ~dV
\end{align}

\vskip 0.25in
The above values of $r_{\phi x}$, $r_{\eta}$, $r_{\eta x}$, $r_{c}$ and $r_{cx}$ are used to define the residuals in the following equations file: \textit{applications/anisotropyFacet/equations.h}

\section{Anisotropy}
The above formulation is generic to any $\gamma(\mathbf{n})$.  In this application, we use an anisotropy of the form
\begin{align}
\gamma(\mathbf{n}) = \gamma_0 \left( 1 - \sum_{i=1} \alpha_i (\mathbf m_i \cdot \mathbf n)^{w_i} \Theta(\mathbf m_i \cdot \mathbf n) \right),
\end{align}
where $\mathbf{m}$ is a unit vector corresponding to a crystallographic orientation, $\gamma_0$ is a scaling factor for interfacial energy, $\alpha_i$ and $w_i$ are scalar parameters specific to each orientation, and $\Theta(\cdot)$ is the Heaviside function.  The derivatives with respect to components of the normal are
\begin{align}
\frac{\partial \gamma(\mathbf{n})}{\partial n_j} = - \gamma_0  \sum_{i=1} w_i \alpha_i m_{ij} (\mathbf m_i \cdot \mathbf n)^{w_i-1} \Theta(\mathbf m_i \cdot \mathbf n) ,
\end{align}
Calculation of $\gamma(\mathbf n)$ and  $\partial \gamma(\mathbf n)/\partial n_j$ is performed in an application-specific function located in \textit{applications/anisotropyFacet/facet\_anisotropy.h}.

This anisotropy was developed by M. Salvalaglio et al. (doi: 10.1021/acs.cgd.5b00165), and is extensively documented in their paper.  Briefly, we note that $\alpha_i$ determines the interfacial energy at the orientation $\mathbf m_i$, and $w_i$ determines how localized the change interfacial energy is around $\mathbf m_i$.  The Heaviside function $\Theta(\mathbf m_i \cdot \mathbf n)$ , which returns zero if $\mathbf m_i \cdot \mathbf n < 0$ and one otherwise, ensures that orientations are considered independently; i.e. there is no change in $\gamma(\mathbf n)$ around $-\mathbf m_1$ unless that corresponds to another listed orientation $\mathbf m_i$.  In its intended configuration, with $0 <\alpha_i < 1$ and high $w_i$ (e.g. $w_i = 50$), this anisotropy results in nearly flat facets at the orientations $\mathbf m_i$.

\end{document} 